

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dainv.da_filtering &mdash; vt_dainv  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="vt_dainv  documentation" href="index.html"/>
        <link rel="up" title="dainv" href="dainv.html"/>
        <link rel="next" title="dainv.dyn_model" href="dainv_dyn_model.html"/>
        <link rel="prev" title="dainv" href="dainv.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> vt_dainv
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_lorenz.html">Tutorial: Lorenz63</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="source_code.html">Source Code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vt_dainv.html">vt_dainv.py (exec)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="dainv.html">dainv</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">dainv.da_filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="dainv_dyn_model.html">dainv.dyn_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="dainv_utilities.html">dainv.utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">vt_dainv</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="source_code.html">Source Code</a> &raquo;</li>
        
          <li><a href="dainv.html">dainv</a> &raquo;</li>
        
      <li>dainv.da_filtering</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/dainv_da_filtering.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-dainv.da_filtering">
<span id="dainv-da-filtering"></span><h1>dainv.da_filtering<a class="headerlink" href="#module-dainv.da_filtering" title="Permalink to this headline">¶</a></h1>
<p>Collection of different filtering techniques.</p>
<dl class="class">
<dt id="dainv.da_filtering.DAFilter">
<em class="property">class </em><code class="descclassname">dainv.da_filtering.</code><code class="descname">DAFilter</code><span class="sig-paren">(</span><em>nsamples</em>, <em>da_interval</em>, <em>t_end</em>, <em>forward_model</em>, <em>input_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Parent class for data assimilation filtering techniques.</p>
<p>Use this as a template to write new filtering classes.
The required methods are summarized below.</p>
<dl class="method">
<dt id="dainv.da_filtering.DAFilter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>nsamples</em>, <em>da_interval</em>, <em>t_end</em>, <em>forward_model</em>, <em>input_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input file and assign values to class attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nsamples</strong> (<em>int</em>) &#8211; Ensemble size.</li>
<li><strong>da_interval</strong> (<em>float</em>) &#8211; Iteration interval between data assimilation steps.</li>
<li><strong>t_end</strong> (<em>float</em>) &#8211; Final time.</li>
<li><strong>forward_model</strong> (<a class="reference internal" href="dainv_dyn_model.html#dainv.dyn_model.DynModel" title="dainv.dyn_model.DynModel"><em>DynModel</em></a>) &#8211; Dynamic model.</li>
<li><strong>input_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>]</em><em></em>) &#8211; All filter-specific inputs.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform any necessary cleanup at completion.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create any relevant plots.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter.report">
<code class="descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Report summary information.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter.save">
<code class="descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save any important results to text files.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement the filtering technique.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dainv.da_filtering.DAFilter2">
<em class="property">class </em><code class="descclassname">dainv.da_filtering.</code><code class="descname">DAFilter2</code><span class="sig-paren">(</span><em>nsamples</em>, <em>da_interval</em>, <em>t_end</em>, <em>forward_model</em>, <em>input_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2" title="Permalink to this definition">¶</a></dt>
<dd><p>Parent class for DA filtering techniques.</p>
<p>This class includes more methods than the DAFilter class.
The DAFilter class is a barebones template. DAFilter2 contains
several methods (e.g error checking, plotting, reporting) as well
as a framework for the main self.solve() method. This can be used
to quickly create new filter classes if some of the same methods
are desired.</p>
<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>nsamples</em>, <em>da_interval</em>, <em>t_end</em>, <em>forward_model</em>, <em>input_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input file and assign values to class attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nsamples</strong> (<em>int</em>) &#8211; Ensemble size.</li>
<li><strong>da_interval</strong> (<em>float</em>) &#8211; Iteration interval between data assimilation steps.</li>
<li><strong>t_end</strong> (<em>float</em>) &#8211; Final time.</li>
<li><strong>forward_model</strong> (<a class="reference internal" href="dainv_dyn_model.html#dainv.dyn_model.DynModel" title="dainv.dyn_model.DynModel"><em>DynModel</em></a>) &#8211; Dynamic model.</li>
<li><strong>input_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>]</em><em></em>) &#8211; All filter-specific inputs.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Inputs in <code class="docutils literal"><span class="pre">input_dict</span></code>:</dt>
<dd><ul class="first last simple">
<li><strong>save_folder</strong> (<code class="docutils literal"><span class="pre">string</span></code>, <code class="docutils literal"><span class="pre">./results_da</span></code>) -
Folder where to save results.</li>
<li><strong>debug_flag</strong> (<code class="docutils literal"><span class="pre">bool</span></code>, <code class="docutils literal"><span class="pre">False</span></code>) -
Save extra information for debugging.</li>
<li><strong>debug_folder</strong> (<code class="docutils literal"><span class="pre">string</span></code>, <code class="docutils literal"><span class="pre">./debug</span></code>) -
Folder where to save debugging information</li>
<li><strong>verbosity</strong> (<code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">1</span></code>) -
Amount of information to print to screen.</li>
<li><strong>sensitivity_only</strong> (<code class="docutils literal"><span class="pre">bool</span></code>, <code class="docutils literal"><span class="pre">False</span></code>) -
Perform initial perturbation but no data assimilation).</li>
<li><strong>reach_max_flag</strong> (<code class="docutils literal"><span class="pre">bool</span></code>, <code class="docutils literal"><span class="pre">True</span></code>) -
Do not terminate simulation when converged.</li>
<li><strong>convergence_option</strong> (<code class="docutils literal"><span class="pre">str</span></code>, <code class="docutils literal"><span class="pre">variance</span></code>) -
Convergence criteria to use if <code class="docutils literal"><span class="pre">reach_max_flag</span></code> is
<code class="docutils literal"><span class="pre">False</span></code>: <code class="docutils literal"><span class="pre">variance</span></code> to use the variance convergence
criteria,  <code class="docutils literal"><span class="pre">residual</span></code>. See documentation for more
information.</li>
<li><strong>convergence_residual</strong> (<code class="docutils literal"><span class="pre">float</span></code>) -
Residual value for convergence if <code class="docutils literal"><span class="pre">reach_max_flag</span></code> is
<code class="docutils literal"><span class="pre">False</span></code> and <code class="docutils literal"><span class="pre">convergence_option</span></code> is <code class="docutils literal"><span class="pre">residual</span></code>.</li>
<li><strong>convergence_norm</strong> (<code class="docutils literal"><span class="pre">int,</span> <span class="pre">inf</span></code>,``2``) -
Order of norm to use for convergence criteria. can be an
integer or <code class="docutils literal"><span class="pre">np.inf</span></code>. Default is L2 norm.</li>
</ul>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup before exiting.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.correct_forecasts">
<code class="descname">correct_forecasts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.correct_forecasts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.correct_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the propagated ensemble (filtering step).</p>
<dl class="docutils">
<dt><strong>Updates:</strong></dt>
<dd><ul class="first last simple">
<li>self.state_vec</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot iteration convergence.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.report">
<code class="descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Report summary information.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.save">
<code class="descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves results to text files.</p>
</dd></dl>

<dl class="method">
<dt id="dainv.da_filtering.DAFilter2.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#DAFilter2.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.DAFilter2.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the parameter estimation problem.</p>
<p>This is the main method for the filter. It solves the inverse
problem. It has options for sensitivity analysis, early
stopping, and output debugging information. At each iteration
it calculates misfits using various norms, and checks for
convergence.</p>
<dl class="docutils">
<dt><strong>Updates:</strong></dt>
<dd><ul class="first last simple">
<li>self.time</li>
<li>self.iter</li>
<li>self.da_step</li>
<li>self.state_vec</li>
<li>self.model_obs</li>
<li>self.obs</li>
<li>self.obs_error</li>
<li>self.state_vec_analysis_all</li>
<li>self.state_vec_forecast_all</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dainv.da_filtering.EnKF">
<em class="property">class </em><code class="descclassname">dainv.da_filtering.</code><code class="descname">EnKF</code><span class="sig-paren">(</span><em>nsamples</em>, <em>da_interval</em>, <em>t_end</em>, <em>forward_model</em>, <em>input_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#EnKF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.EnKF" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the ensemble Kalman Filter (EnKF).</p>
<p>It inherits most methods from parent class (<code class="docutils literal"><span class="pre">DAFIlter2</span></code>), but
replaces the <code class="docutils literal"><span class="pre">correct_forecasts</span></code> method to use EnKF for the
data-assimilation step.</p>
<p>The EnKF is updated by: <code class="docutils literal"><span class="pre">Xa</span> <span class="pre">=</span> <span class="pre">Xf</span> <span class="pre">+</span> <span class="pre">K*(obs</span> <span class="pre">-</span> <span class="pre">HX)</span></code> where <em>Xf</em> is
the forecasted state vector (by the forward model), <em>Xa</em> is the
updated vector after data-assimilation, <em>K</em> is the Kalman gain
matrix, <em>obs</em> is the observation vector, and <em>HX</em> is the forecasted
state vector in observation space. See the documentation for more
information.</p>
<dl class="method">
<dt id="dainv.da_filtering.EnKF.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>nsamples</em>, <em>da_interval</em>, <em>t_end</em>, <em>forward_model</em>, <em>input_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dainv/da_filtering.html#EnKF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dainv.da_filtering.EnKF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input file and assign values to class attributes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See DAFilter2.__init__ for details.</p>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dainv_dyn_model.html" class="btn btn-neutral float-right" title="dainv.dyn_model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dainv.html" class="btn btn-neutral" title="dainv" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, carlos.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>